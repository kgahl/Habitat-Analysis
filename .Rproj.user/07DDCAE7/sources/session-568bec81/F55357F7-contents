#Kaitlyn Gahl
#1/3/2023
#Making text numeric
#Pre-cursor to AllData 

install.packages("dplyr")
install.packages("readr")
library(dplyr)

library(readr)
library(tidyverse)
library(dplyr)
library(tidyr)
library(lme4)
library(ggplot2)
library(glmmTMB)



################################ WEST CLEAR ################################
##### West Clear 3 (March) #####

##Import data, blanks = na, rename columns, keep important columns

Habitat <- read.csv("data/West Clear/WestClear.March.csv", na =c("","na")) %>%
           rename(CI = Substrate, Occupancy = Site.Type, Overhead = Canopy.Cover, 
                  Tag = Tag.Number)

Habitat <- mutate(Instream = c(Substrate.Feature + Surface.Turbulence + 
                               Aquatic.Vegetation + Large.Woody.Debris +
                               Terrestrial.Vegetation + Undercut.Bank)) %>%
           select(Mesohabitat, Depth.cm, Velocity.ms, CI, Occupancy, 
                  Overhead, Instream, Tag)

Fish <- read.csv("data/Radio_Tagged_Fish.csv") %>%
        select(Tag, Species)
    
    
## Merge Habitat and Tag data 

Clear_March <- Habitat %>%
  merge(Fish, Habitat, by.x = 'Tag', by.y = 'Tag', all.x = TRUE) %>%
  select(Species, Occupancy, Mesohabitat, Depth.cm, Velocity.ms, CI,
         Overhead, Instream)

Clear_March$Species[is.na(Clear_March$Species)] <- "Available"
  
  
## Make named categories into numeric code
  #changed >150 depth to 151
Clear_March <- Clear_March %>% 
  mutate(Occupancy = recode(Occupancy, "Occupied" = "1", "Available" = "0"),
         CI = recode(CI, "Silt" = "0", "Sand" = "1", "Gravel" = "2", 
                         "Pebble" = "3", "Cobble" = "4", "Boulder" = "5", 
                         "Bedrock" = "6"),
         Mesohabitat = recode(Mesohabitat, "Pool_" = "Pool"), 
         Mesohabitat = recode(Mesohabitat, "Pool" = "0", "Riffle" = "1", "Run" = "2"),
         Overhead = recode(Overhead, "Yes" = "1", "No" = "0"),
         Depth.cm = recode(Depth.cm, ">150" = "151"))
  
## Split into Desert Sucker and Bass
  #Desert Sucker
    Clear_March_DS <- Clear_March %>% 
      filter(Species %in% c("Desert Sucker", "Available"))
      
    write.csv(Clear_March_DS, file = "Clear_March_DS") 
    
    "C:\\Users\\kaitl\\OneDrive\\Documents\\School\\
                Bonar Lab\\Project\\Data\\Analysis\\Data Ready for HSC\\
                Clear_March_DS.csv", row.names=FALSE)
    
   # write_xlsx(the dataframe name,"path to store the Excel file\\file name.xlsx")
  #Black Bass
    Clear_March_BB <- Clear_March %>% 
      filter(Species %in% c("Black Bass", "Available"))

# Need to combine habitat cover percentages to get one number then include Instream Cover in this select




#import creek-month
#add section to include fish type from tag number
#add together %instream cover 
#sort everything into binary/numeric
#split desert sucker from bass

#Clear_March[is.na(Clear_March)] <- NA
#replace(is.na(.), "") %>%
    
    
#### Graveyard #### 
"Depth.cm" = Depth..cm., "Velocity.ms" = Velocity..m.s.
    
    
    ##### West Clear 3 (March) #####
    
    ##Import data, blanks = na, rename columns, keep important columns
    
    Habitat <- read.csv("School/Bonar Lab/Project/Data/Analysis/Data Ready for HSC/Data-Ready-for-HSC/Data/West Clear/WestClear.3.March.csv", na =c("","na"))
    Fish <- read.csv("School/Bonar Lab/Project/Data/Analysis/Data Ready for HSC/Data-Ready-for-HSC/Data/Radio_Tagged_Fish.csv", na =c("","na"))
    
    ## Merge Habitat and Tag data 
    
    FishHab <- Habitat %>%
      merge(Fish, Habitat, by.x = 'Tag', by.y = 'Tag', all.x = TRUE)
      
    
    view(FishHab)
    write.csv(FishHab, file = "WCMarch.csv")
    
    #Separate Species
    Available <- FishHab %>%
      filter(Site.Type %in% c("Available"))
    
    DSFishHab <- FishHab %>%
      filter(Species %in% c("Desert Sucker"))
    DSFishHab <- rbind(Available, DSFishHab)
    write.csv(DSFishHab, file = "WCAprilDS.csv") 
    
    BBFishHab <- FishHab %>%
      filter(Species %in% c("Black Bass"))
    BBFishHab <- rbind(Available, BBFishHab)
    write.csv(DSFishHab, file = "WCAprilBB.csv") 
    remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)
    

############# WC April #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.April.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCApril.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(Available, DSFishHab)
write.csv(DSFishHab, file = "WCAprilDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(Available, BBFishHab)
write.csv(DSFishHab, file = "WCAprilBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)



############# WC May #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.May.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCMay.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCMayDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCMayBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)


############# WC June #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.June.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCJune.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCJuneDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCJuneBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)


############# WC July #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.July.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCJuly.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCJulyDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCJulyBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)


############# WC September #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.September.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCSeptember.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCSeptemberDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCSeptemberBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)


############# WC October #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.October.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCOctober.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCOctoberDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCOctoberBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)


############# WC November #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.November.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCNovember.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCNovemberDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCNovemberBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)


############# WC December #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("data/West Clear/WestClear.December.csv", na =c("","na"))
Radio_Tagged_Fish <- read_csv("data/Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

view(FishHab)
write.csv(FishHab, file = "WCDecember.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WCDecemberDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WCDecemberBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)

############# WB April #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read.csv("School/Bonar Lab/Project/Data/Analysis/Data Ready for HSC/Data-Ready-for-HSC/Data/Wet Beaver/WetBeaver.April.csv", na =c("","na"))
Radio_Tagged_Fish <- read.csv("School/Bonar Lab/Project/Data/Analysis/Data Ready for HSC/Data-Ready-for-HSC/Data/All_Radio_Tagged_Fish.csv", na =c("","na"))
view(Habitat_Data)
view(Radio_Tagged_Fish)

## Merge Radio Tagged Fish and Habitat Data 
FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag',
        all.x = TRUE) %>%
  select(Stream, Creation.Date, Site.Type, Tag, Stream.Width.m, Mesohabitat, Depth.cm, 
         Velocity.ms, Substrate, Instream.Cover, Canopy.Cover)

view(FishHab)
write.csv(FishHab, file = "WBApril.csv")

#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))

DSFishHab <- FishHab %>%
  filter(Species %in% c("Desert Sucker"))
DSFishHab <- rbind(DSFishHab,Available)
view(DSFishHab)
write.csv(DSFishHab, file = "WBAprilDS.csv") 

BBFishHab <- FishHab %>%
  filter(Species %in% c("Black Bass"))
BBFishHab <- rbind(BBFishHab, Available)
view(BBFishHab)
write.csv(DSFishHab, file = "WBAprilBB.csv") 
remove(Habitat_Data, FishHab, Available, DSFishHab,BBFishHab)



############# WB April #####################
### Add individual fish data from Radio Tagged Fish to Habitat Data data frame -establish species for each tag number
## Import Radio Tagged Fish data and change "Tag" column name to "Tag Number" 

Habitat_Data <- read_csv("WCSeptember.csv", na =c("","na"))

FishHab <- Habitat_Data %>%
  merge(Radio_Tagged_Fish, Habitat_Data, by.x = 'Tag', by.y = 'Tag', 
        all.x = TRUE)

write.csv(FishHab, file = "WC_September.csv")



#Separate Species
Available <- FishHab %>%
  filter(Site.Type %in% c("Available"))




